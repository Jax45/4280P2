Now need to implement lookahead.
